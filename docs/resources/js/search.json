[[{"l":"WindowsBuildCertificate","p":["A PowerShell 7 automation and validation toolkit for Windows device build certification. This project ensures all required software, settings, and configurations are completed, validated, and documented for ITSM and compliance.","It's really great that you're interested in it.","However, this repository is still under major development and testing, and isn't even close to being ready for prime time use.","Please feel welcome to let me know if you feel there's anything that could be done or enhanced as I get this ready for prime time, or if you'd like to contribute."]},{"l":"Table of Contents","p":["Project Overview","Features","Getting Started","Usage","Folder Structure","Modules and Functions","Testing","Logging, Error Handling and Troubleshooting","Accessibility","Contributing","Changelog","License & Credits","Contact and Support"]},{"l":"Project Overview","p":["WindowsBuildCertificate automates and validates the build process for Windows devices, ensuring all required steps are completed and documented. It supports pre- and post-deployment scripting, user prompts, and robust logging for ITSM workflows.","For more information, please see Project Overview."]},{"l":"Features","p":["Modular PowerShell 7 scripts for pre/post build","Device and configuration validation (naming, Secure Boot, BitLocker, PCR7, etc.)","Company Portal, OneDrive, Office 365, Teams, Edge, and required app checks","Intune and AD join validation","Build certificate generation and export","Robust logging, error handling, and accessibility","Exportable scripts for OOBE and post-deployment integration","For more information, please see Features."]},{"l":"Getting Started","p":["For more information, please see Getting Started.","Clone the repository and review the documentation.","Configure your build steps and modules as needed.","Use the provided scripts to automate and validate your device builds."]},{"l":"Usage","p":["See scripts/ for main entry points.","See modules/ for reusable functions.","See tests/ for Pester and validation scripts.","For more information, please see Menu Structure."]},{"l":"Folder Structure","p":["For more information, please see Folder Structure."]},{"l":"Modules and Functions","p":["For more information, please see Modules and Functions."]},{"l":"Testing","p":["Pester tests for critical functions","Manual and automated validation steps","For more information, please see Testing."]},{"l":"Logging, Error Handling and Troubleshooting","p":["Logs are written to $env:TEMP/WindowsBuildCertificate.log","More informationm on Logs is available at Logging and Error Handling","See KNOWNISSUES.md for troubleshooting"]},{"l":"Accessibility","p":["All scripts and documentation follow accessibility and EN-AU standards","For more information, please see Accessibility."]},{"l":"Contributing","p":["For guidelines, please see Contributing."]},{"l":"Changelog","p":["For release history, please see Changelog."]},{"l":"License & Credits","p":["WindowsBuildCertificate Copyright (c) 2025, Michael Harris. All rights reserved.","Released under the MIT License. See LICENSE; and Donations and thank you's if you would like to contribute or say thank you for this project."]},{"l":"Contact and Support","p":["For support or to open a GitHub issue, please see Support."]}],[{"l":"User Guides","p":["Getting Started","Testing","Testing Tree","Testing Snippets","Testing Code","Backup and Restore","Accessibility","Menu Structure"]}],[{"l":"Getting Started","p":["Clone the repository and review the documentation.","Configure your build steps and modules as needed.","Use the provided menu options, scripts and the like to automate and prepare your build scripts. Information on menu options for navigation is available from Menu Structure.","Follow available documentation to add these resulting scripts into your build image or process."]}],[{"l":"Backup and Restore","p":["Document how to back up build status and certificates","Provide steps for restoring from backup","Include sample scripts for backup/restore"]}],[{"l":"Testing","p":["Pester tests for all critical functions","Manual validation of menu and script flows","Automated regression checks after major changes","Document test cases and expected outputs","Review test coverage and update as needed"]}],[{"l":"Testing Code"}],[{"l":"Testing Snippets","p":["Example: [ ] Pester tests for all critical functions","Example: [ ] Document test cases and expected outputs"]}],[{"l":"Testing Tree","p":["// TESTING","// TODO: Pester tests for all critical functions","// TODO: Manual validation of menu and script flows","// TODO: Automated regression checks after major changes","// TODO: Document test cases and expected outputs","// TODO: Review test coverage and update as needed"]}],[{"l":"Accessibility"},{"l":"Overview","p":["Menu titles use blue (cyan) for visibility.","Documentation/resource sections use purple (magenta).","All user-facing output is clear, concise, and accessible.","No technical log details are shown to the user in the terminal."]},{"l":"TODO's and items to check","p":["All scripts and documentation follow accessibility and EN-AU standards","Review output and documentation for screen reader compatibility","Use inclusive language throughout"]}],[{"l":"Logging and error handling","p":["Logging","Error Handling"]},{"l":"Logging","p":["Transcript log: Captures the full session (PowerShell transcript).","Custom log: Records all menu actions, errors, and warnings in a separate file for audit and troubleshooting.","No file conflicts: Logging is robust and avoids file access errors by separating transcript and custom logs."]},{"l":"Error Handling","p":["Errors and warnings are shown in colour in the terminal.","All details are logged in the custom log file for review."]}],[{"l":"Menu Overview","p":["Main menu for build actions","Options for continuing, viewing, or restarting builds","Prompts for user name and build status","Step-by-step validation and export options"]},{"l":"Menu Structure","p":["Menus are modular, accessible, and colour-coded for clarity:","Help and documentation sections use purple for emphasis. All menu navigation and actions are logged for audit and troubleshooting."]},{"l":"Current menus","p":["All menus are modular PowerShell functions. Menu titles use blue, documentation/resources use purple, and all actions are logged. See code for details on menu logic and accessibility."]}],[{"l":"Design Philosophy","p":["Modular, maintainable PowerShell 7 codebase","Robust error handling and logging","Accessibility and EN-AU compliance","User-driven configuration and export","Documentation-first approach"]}],[{"l":"Folder Structure"}],[{"l":"Project Idea","p":["Purpose","Scope","Key Outcomes"]},{"l":"Purpose","p":["Automate and validate the build process for Windows devices, during imaging, and post-imaging - by speeding up Intune enrolment, and ensuring all required software, settings, and configurations are completed, validated, and installed; plus providing documentation for quality control, compliance, and documentation of same in an appropriate ticketing system."]},{"l":"Scope","p":["Ability to give a name and generation/last update date to a configuration, for ease of reference and review during configuration selection process","Accessible output and error handling for all users","Build certificate in post-deployment script","Build script based on most current configuration, or a past configuration","Command-line CLI, to perform all functions and activities","Copying of build certificate to clipboard, for ease of transmission to other systems","Creates a single script, accessible from within Powershell during OOBE, to connect to Intune and enrol device for Autopilot","Customise what exact steps are to be done in the post deployment phase","Generation of a text-based Build certificate, stored at a user-defined location","Modular, colour-coded CLI menus for clear navigation and accessibility","Modular, maintainable PowerShell 7 codebase","Post deployment scripts","Pre deployment scripts","Robust fallback for autopilot enrolment, regardless of code run in PowerShell 5 or 7","Robust logging of activities, including --Logverbose option when running CLI, to understand exactly what was done at any point","Robust validation and error handling","Robust, separate logging for user actions and session transcript","Script generation","Session and progress persistence: If an incomplete build session is detected when running the post deployment script, it will detect the incomplete session, and provide option to continue on with script, whilst also not repeating any steps already confirmed as successfully completed (important if neeeding to reboot device)","Storage of current configuration","User journey: From main menu, users can manage deployment configs, export scripts, view logs, or access help/documentation, all with clear feedback and logging","User-driven configuration and export of OOBE and post-deployment scripts","Validation and documentation of all steps along the way","Version control and backup of current and past configurations and configuration scripts","Will automate process as much as possible for installation and configuration not handled elsewhere"]},{"l":"Key Outcomes","p":["For organisations where an IT staff is responsible for preparing and delivering devices - these scripts will enable you to deliver employees ready-to-go devices, with no further steps on your or the users part, and minimising the time and effort needed on your part to achieve it.","Reliable, repeatable device builds","Reduces staff time and effort during device configuration and delivery activities","Compliance with organisational and ITSM requirements","Accessible, well-documented scripts and processes"]}],[{"l":"Specification","p":["Overview","Configuration Management and Script Generation","Session and Progress Persistence","Robustness and Error Handling","Build Certificate","Scirpt progress, Documentation and Compliance","Requirements","Success Criteria","Key Outcomes","Menu Presentation","Logging","Error/Warning Handling","Code examples","Build certificate generate in the post-deployment script","Post-deployment script code to date, assuming everything is checked for"]},{"l":"Overview","p":["This project provides a modular PowerShell 7 toolkit to automate and validate Windows device builds, including:","Device and configuration validation (naming checks - as naming needs to be done when logged in as an administrator on the device, Secure Boot, BitLocker, PCR7, etc.)","Company Portal, OneDrive, Office 365, Teams, Edge, and required app checks","Intune and AD join validation","Build certificate generation and export","Robust logging, error handling, and accessibility","The project will acheive and provide these functions this by providing a text-based CLI for the user."]},{"l":"Configuration Management and Script Generation","p":["Handled in a CLI, preferably and most likely text-based from the outset of the project","Subject to difficulty, may also be a Windows Forms UI that is automatically maintained as features in the project are added, removed, updated, or adjusted.","Store and version current and past configurations, with user-defined names and last update dates for reference.","Enable user-driven configuration and export of OOBE and post-deployment scripts.","Allow customisation of post-deployment steps and script content.","Customisation is via a text-based CLI method, where options can be switched on or off easily on a single screen","Provide backup/version control for configuration scripts.","Ensure all configuration changes are logged and auditable."]},{"l":"Session and Progress Persistence","p":["Post-deployment scripts must detect incomplete build sessions and offer the option to continue without repeating already completed steps.","Persist session and progress state to support device reboots and interrupted builds."]},{"l":"Robustness and Error Handling","p":["Provide robust fallback for Autopilot enrolment, supporting both PowerShell 5 and 7.","Implement comprehensive validation and error handling for all steps.","Include detailed logging of the CLI, pre and post deployment scripts, with a --Logverbose option for in-depth diagnostics.","Ensure all scripts are idempotent and safe to re-run."]},{"l":"Build Certificate","p":["Generate a text-based build certificate at a user-defined location.","Copy the build certificate to the clipboard for easy transmission.","Include all relevant build, validation, and configuration details in the certificate."]},{"l":"Scirpt progress, Documentation and Compliance","p":["All script outputs, messages, information, and details passed to the user interface - regardless of the CLI or script being ran - must be clear, concise, specific, detailled, include errors from the system, and enable appropriate next best actions to overcome or address the issue.","Provide documentation for quality control, compliance, and integration with ITSM/ticketing systems.","Documentation and code must include references to official documentation for all commands run and modules used.","Ensure all scripts and documentation are accessible, well-structured, and use EN-AU spelling.","Maintain a Retype static documentation site, with regular updates and version control."]},{"l":"Requirements","p":["PowerShell 7 compatibility","User interface for script generation and management, ideally from a command-line based CLI in the first instance","Modular scripts and functions","User prompts and menu-driven flows","Exportable scripts for OOBE and post-deployment","Retype static documentation site","CI/CD and linting integration","Configuration management and versioning","Session and progress persistence","Robust error handling and logging","Accessibility and compliance with EN-AU standards"]},{"l":"Success Criteria","p":["All build steps are validated and logged","Build certificate is generated, exportable, and includes all required details","Session and progress are reliably persisted and recoverable","Documentation and code meet accessibility and EN-AU standards","All requirements above are met without regression or loss of existing functionality"]},{"l":"Key Outcomes","p":["Reliable, repeatable device builds","Reduced staff time and effort for device configuration and delivery","Compliance with organisational and ITSM requirements","Accessible, well-documented scripts and processes"]},{"l":"Menu Presentation","p":["All menu titles must use blue (cyan) for visibility.","Documentation/resources in help menus must use purple (magenta).","All other output must be accessible and clear."]},{"l":"Logging","p":["Use two log files: transcript (session) and custom (actions/errors).","All menu actions, errors, and warnings must be logged in the custom log file.","No direct writes to the transcript file except via Start-Transcript."]},{"l":"Error/Warning Handling","p":["Errors and warnings are shown in colour in the terminal.","All details are logged in the custom log file."]},{"l":"Code examples"},{"l":"Build certificate generate in the post-deployment script"},{"l":"Post-deployment script code to date, assuming everything is checked for"}],[{"l":"Issues","p":["This section tracks known issues, todos, and outstanding tasks for the project. See todo.md and knownissues.md for details."]}],[{"l":"Known Issues","p":["Linting: Some markdown files may trigger MD022/MD032 due to blank line requirements. These will be addressed in future updates.","Windows Update: Fallback to manual update may be required if PSWindowsUpdate fails.","Some checks require user interaction (e.g., Company Portal, OneDrive sign-in).","Ensure all scripts are run in PowerShell 7; prompt and assist user if not present.","Document any new issues here as they arise.","[RESOLVED] Log file access conflict: Custom log and transcript log are now separated to prevent file locking errors.","Colour accessibility: Blue and purple menu titles may not be visible to all users; consider future improvements for high-contrast or alternative themes.","Some menu logic is stubbed and will be completed in future updates."]}],[{"l":"TODO","p":["Modularise all step logic into functions and modules","Implement robust logging and error handling","Add user prompts and menu-driven flows","Export OOBE and post-deployment scripts","Integrate Pester tests for critical functions","Set up CI/CD and linting","Complete Retype documentation site setup","Review and update documentation for accessibility and EN-AU compliance","Test menu accessibility and colour contrast","Validate custom log file output and error handling","Regression test all menu navigation and logging","Keep documentation and screenshots up to date with menu changes"]}],[{"l":"TODO Code"}],[{"l":"TODO Snippets","p":["Example: [ ] Implement robust error handling","Example: [ ] Add user prompts and menu-driven flows"]}],[{"l":"TODO Tree","p":["Modularise all step logic into functions and modules","Implement robust logging and error handling","Add user prompts and menu-driven flows","Export OOBE and post-deployment scripts","Integrate Pester tests for critical functions","Set up CI/CD and linting","Complete Retype documentation site setup","Review and update documentation for accessibility and EN-AU compliance"]}],[{"l":"Code","p":["This section documents all modules and functions in the project. See modules.md for a full list and descriptions."]}],[{"l":"Modules and Functions","p":["See inline documentation in each module for details on parameters, return values, and usage.","CLI Modules","LogsCLI","HelpCLI","MainMenuCLI","DeploymentCLI","Logging Module","Logging","Modules yet to be built","BuildCertificate","DeviceChecks","AppChecks","IntuneADChecks","ExportScripts"]},{"l":"CLI Modules","p":["All CLI modules present menu titles in blue (cyan) and documentation/resources in purple (magenta).","All menu actions, errors, and warnings are logged using Write-Log, which writes only to the custom log file.","User-facing output is always accessible and free of technical log details."]},{"l":"LogsCLI","p":["File location: modules/LogsCLI.psm1","Purpose: Provides all log management CLI, menu, and functions for WindowsBuildCertificate.","Functions:","Get-LogsMenu: Displays the logs menu and routes user choices to log management actions.","Get-CurrentSessionLog: Opens the current session log file in Notepad for review.","Get-PastSessionLogs: Allows selection and viewing of past session logs, with Out-GridView or console fallback.","Save-OldLogs: Compresses previous months' logs into a zip archive and removes originals."]},{"l":"HelpCLI","p":["File location: modules/CLI/HelpCLI.psm1","Purpose: Provides the About, Help & Instructions menu for WindowsBuildCertificate.","Functions:","Show-HelpMenu: Displays the About, Help & Instructions menu, including project information, copyright, license, and documentation links. Allows the user to open links in the browser or return to the main menu. Logs all actions."]},{"l":"MainMenuCLI","p":["File location: modules/CLI/MainMenuCLI.psm1","Purpose: Provides the main menu CLI and related functions for WindowsBuildCertificate.","Functions:","Show-MainMenu: Displays the main menu, handles user selection, and routes to the appropriate submenu or action. Handles logging and menu navigation.","Invoke-ExportScripts: Stub for script export logic from the main menu. Logs the action and prompts the user to return to the main menu. (Functionality to be implemented.)"]},{"l":"DeploymentCLI","p":["File location: modules/DeploymentCLI.psm1","Purpose: Provides deployment script configuration management CLI and menu for WindowsBuildCertificate.","Functions:","Show-DeploymentMenu: Displays the deployment configuration management menu and routes user choices.","New-DeploymentConfig: Creates a new deployment script configuration (stub; logic to be implemented).","Edit-DeploymentConfig: Edits an existing deployment script configuration (stub; logic to be implemented).","Export-DeploymentScripts: Exports scripts from an existing deployment script configuration (stub; logic to be implemented).","Save-OldDeploymentConfigs: Archives deployment configurations not used in the last 90 days (stub; logic to be implemented).","Restore-ArchivedDeploymentConfig: Retrieves an archived deployment configuration (stub; logic to be implemented).","Edit-DefaultDeploymentConfig: Creates or edits the default configuration for all new deployment scripts (stub; logic to be implemented)."]},{"l":"Logging Module","p":["Standardised logging and error handling for all scripts and modules."]},{"l":"Logging","p":["File location: modules/Logging.psm1","Purpose: Accepts message, level, menu option, and log file, writes to relevant file accordingly","Functions:","Write-Log: Accepts message, level, menu option, and log file. Writes full detail to the custom log file and only user-facing messages to the terminal, with appropriate colour.","This document lists all modules and functions in the WindowsBuildCertificate project, with a summary of their purpose and usage."]},{"l":"Modules yet to be built"},{"l":"BuildCertificate","p":["File location: modules/BuildCertificate.psm1","Purpose: Core logic for build validation and certificate generation."]},{"l":"DeviceChecks","p":["File location: modules/DeviceChecks.psm1","Purpose: Functions for device name, Secure Boot, BitLocker, PCR7, and other device compliance checks."]},{"l":"AppChecks","p":["File location: modules/AppChecks.psm1","Purpose: Functions for Company Portal, OneDrive, Office 365, Teams, Edge, and required application checks."]},{"l":"IntuneADChecks","p":["File location: modules/IntuneADChecks.psm1","Purpose: Functions for Intune, AD join, and sync validation."]},{"l":"ExportScripts","p":["File location: modules/ExportScripts.psm1","Purpose: Logic for OOBE and post-deployment script export."]}],[{"l":"Support","p":["For help, open a GitHub issue or contact the maintainer via the repository page."]}],[{"l":"Support","p":["For help, open a GitHub issue or contact the maintainer via the repository page."]}],[{"l":"Contributing","p":["See contributing for guidelines."]}],[{"l":"Contributing","p":["Thank you for your interest in contributing to WindowsBuildCertificate!"]},{"l":"Guidelines","p":["Follow EN-AU spelling and accessibility standards","Use modular, well-documented PowerShell 7 code","Run PSScriptAnalyzer and markdownlint before submitting PRs","Document all changes in CHANGELOG.md","Update documentation and tests as needed"]},{"l":"Code Review Checklist","p":["Adherence to project instructions and standards","Test coverage for new/changed code","Security and error handling","Accessibility and inclusive language"]},{"l":"Reporting Issues","p":["Use GitHub Issues for bugs, feature requests, and questions","Provide clear steps to reproduce and expected behaviour"]}],[{"l":"Changelog","p":["All notable changes to this project will be documented in this file."]},{"l":"[Unreleased]","p":["Initial project structure and documentation","Modularisation and script export logic","Retype documentation site setup"]}],[{"l":"Testing","p":["Pester tests for all critical functions","Manual validation of menu and script flows","Automated regression checks after major changes","Document test cases and expected outputs","Review test coverage and update as needed"]}],[{"l":"TODO","p":["Modularise all step logic into functions and modules","Implement robust logging and error handling","Add user prompts and menu-driven flows","Export OOBE and post-deployment scripts","Integrate Pester tests for critical functions","Set up CI/CD and linting","Complete Retype documentation site setup","Review and update documentation for accessibility and EN-AU compliance","Test menu accessibility and colour contrast","Validate custom log file output and error handling","Regression test all menu navigation and logging","Keep documentation and screenshots up to date with menu changes"]}],[{"l":"LICENSE"},{"l":"MIT License","p":["Copyright (c) 2025, Michael Harris, All rights reserved.","Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:","The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.","THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."]}],[{"l":"Donations and thank you's","p":["Like to say thank you?"]},{"l":"Like to say thank you?","p":["Feel welcome to:","Buy me a ko-fi"]}]]